import{d as le,f,s as ae,x as oe,c as d,a as e,w as l,F as p,r as i,o as n,b as V,j as g,i as _,t as C,u as ne,h as y,m as b,y as se}from"./index-CY5MZRSK.js";import{b as ue}from"./product-BkGacIZ_.js";import{g as re}from"./vendor-DbpwKbUy.js";import{P as de}from"./product_card-tpfW6yDo.js";const ie=["innerHTML"],ce={key:0},ve={key:0},fe={key:0},_e={key:0},me={class:"my-4"},Ve=le({__name:"[special_code]",setup(pe){const B=f([]),D=f([]),$=f([]),j=f([]),T=ae(),w=f(!1),A=oe().params.special_code,s=f(),E=f(""),F=f(1),H=f([]),I=f(999),L=f(!1),U=f(!1),M=f();let N;const G=async r=>{var t,c,k,o,v;try{const x=await ue(r);if(x.status===200){s.value=x.data,N=x.data.product_info.id;const m=(t=x.data.products_variants[0])==null?void 0:t.special_code;E.value=m,Q(m),N&&K(N),(c=s.value)!=null&&c.product_info.ingredients.前調&&(B.value=s.value.product_info.ingredients.前調),(k=s.value)!=null&&k.product_info.ingredients.中調&&(D.value=s.value.product_info.ingredients.中調),(o=s.value)!=null&&o.product_info.ingredients.後調&&($.value=s.value.product_info.ingredients.後調),(v=s.value)!=null&&v.product_info.ingredients.香調&&(j.value=s.value.product_info.ingredients.香調),console.log(B.value),console.log(D.value),console.log($.value),console.log(j.value),J()}}catch(x){console.log(x)}},J=async()=>{try{if(s.value){const r=s.value.product_info.vendor_id,t=await re(r);t.status===200&&(M.value=t.data.filter(c=>c.id!==r).slice(0,3))}}catch(r){console.error("fetchData error:",r)}},Q=r=>{var k;if(!s.value)return;s.value.product_info.description=(k=s.value)==null?void 0:k.product_info.description.replace("/n","<br/>");const t=s.value.product_images_variants.find(o=>o.special_code===r),c=s.value.products_variants.find(o=>o.special_code===r);t?H.value=t.images.map(o=>o.image_url):H.value=[],c?I.value=c.price:I.value=999999},K=r=>{var t;(t=T.user)==null||t.favorites.map(c=>{c==r&&(w.value=!0)})},O=r=>{w.value==!0&&s.value?(T.DelToFavorites(r),w.value=!w.value):(T.addToFavorites(r),w.value=!w.value)},W=async()=>{var r;if(T.user){const t={user_id:(r=T.user)==null?void 0:r.id,special_code:E.value,quantity:F.value};try{(await se(t)).status==200?L.value=!0:U.value=!0}catch(c){console.log(c)}}};return G(A),(r,t)=>{const c=i("v-carousel-item"),k=i("v-carousel"),o=i("v-col"),v=i("v-row"),x=i("RouterLink"),m=i("v-spacer"),h=i("v-btn"),X=i("v-btn-toggle"),Y=i("v-number-input"),q=i("v-divider"),R=i("v-card-title"),P=i("v-card-text"),S=i("v-card-item"),Z=i("v-card"),ee=i("v-img"),te=i("v-container"),z=i("v-snackbar");return n(),d(p,null,[e(te,{"max-width":"1400",class:"mt-11"},{default:l(()=>[e(v,{class:"pb-4"},{default:l(()=>[e(o,{cols:"12",sm:"6"},{default:l(()=>[e(k,{mandatory:"",touch:"","show-arrows":"hover","model-value":"0"},{default:l(()=>[(n(!0),d(p,null,g(H.value,(a,u)=>(n(),y(c,{key:u,src:a,value:u,cover:""},null,8,["src","value"]))),128))]),_:1})]),_:1}),e(o,{cols:"12",sm:"6",class:"md-min-h-[500px]"},{default:l(()=>[e(v,{class:"mt-8 md-min-h-[150px] text-left mx-4"},{default:l(()=>[e(o,{class:"sm-text-10 text-6"},{default:l(()=>{var a;return[_(C((a=s.value)==null?void 0:a.product_info.name),1)]}),_:1})]),_:1}),e(v,{class:"md-min-h-[40px] content-center text-left mx-4"},{default:l(()=>{var a;return[e(x,{to:`/vendor/${(a=s.value)==null?void 0:a.product_info.slug}`},{default:l(()=>[e(o,{class:"text-left text-3 sm-text-4"},{default:l(()=>{var u;return[_(C((u=s.value)==null?void 0:u.product_info.vendor_name),1)]}),_:1})]),_:1},8,["to"]),e(m)]}),_:1}),e(v,{class:"md-min-h-[40px] mx-4 mt-0"},{default:l(()=>[e(o,{class:"text-left"},{default:l(()=>[e(h,{variant:"text",color:"orange-lighten-2",icon:"mdi-share-variant",onClick:t[0]||(t[0]=()=>{})}),e(h,{variant:"text",color:"orange-lighten-2",icon:w.value?"mdi-heart":"mdi-heart-outline",onClick:t[1]||(t[1]=a=>O(ne(N)))},null,8,["icon"])]),_:1}),e(m)]),_:1}),e(v,{class:"md-min-h-[80px] mx-4 items-center"},{default:l(()=>[e(o,{class:"text-left"},{default:l(()=>[e(X,{modelValue:E.value,"onUpdate:modelValue":t[2]||(t[2]=a=>E.value=a),divided:""},{default:l(()=>{var a;return[(n(!0),d(p,null,g((a=s.value)==null?void 0:a.products_variants,u=>(n(),y(h,{text:`${u.capacity}ml`,value:u.special_code,onClick:ge=>Q(u.special_code)},null,8,["text","value","onClick"]))),256))]}),_:1},8,["modelValue"])]),_:1}),e(m),e(o,{class:"font-800 text-5 items-center"},{default:l(()=>[_(" $ "+C(F.value*I.value),1)]),_:1})]),_:1}),e(v,{class:"md-min-h-[100px] mx-4"},{default:l(()=>[e(o,{cols:"12",sm:"4"},{default:l(()=>[e(Y,{"max-width":"300","min-width":"200",reverse:!1,controlVariant:"split",label:"",hideInput:!1,inset:"",variant:"outlined",min:1,modelValue:F.value,"onUpdate:modelValue":t[3]||(t[3]=a=>F.value=a)},null,8,["modelValue"])]),_:1}),e(m),e(o,{cols:"12",sm:"4"},{default:l(()=>[e(h,{variant:"flat",rounded:"xl",size:"large",color:"#EEBF62",class:"text-white font-800",onClick:t[4]||(t[4]=a=>W())},{default:l(()=>t[9]||(t[9]=[_(" 加入購物車 ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(q),e(v,null,{default:l(()=>[e(m),e(o,{cols:"10",class:"my-8"},{default:l(()=>{var a;return[V("div",{class:"overflow-y-auto text-left whitespace-normal",innerHTML:(a=s.value)==null?void 0:a.product_info.description},null,8,ie)]}),_:1}),e(m)]),_:1}),e(q),e(Z,{class:"my-6 bg-white/50 border-[#ECBD69] border-solid border-1px"},{default:l(()=>[e(v,{class:"justify-center"},{default:l(()=>[j.value.length>0?(n(),y(o,{key:0,cols:"auto",sm:"12",class:"sm-border-b-1px sm-border-b-solid sm-border-[#E9B351]"},{default:l(()=>[e(S,null,{default:l(()=>[e(R,{class:"font-bold sm-text-6 text-4"},{default:l(()=>t[10]||(t[10]=[_("香調")])),_:1}),e(P,{class:"flex gap-2 text-center justify-center sm-text-5 text-4"},{default:l(()=>[(n(!0),d(p,null,g(j.value,(a,u)=>(n(),d("div",{key:u,class:"flex gap-2"},[V("div",null,C(a),1),u+1!=j.value.length?(n(),d("div",ce,"、")):b("",!0)]))),128))]),_:1})]),_:1})]),_:1})):b("",!0),B.value.length>0?(n(),y(o,{key:1,cols:"auto",sm:"auto"},{default:l(()=>[e(S,null,{default:l(()=>[e(R,{class:"font-bold sm-text-6 text-4"},{default:l(()=>t[11]||(t[11]=[_("前調")])),_:1}),e(P,{class:"flex gap-2 text-center justify-center sm-text-5 text-4 max-w-[80vw] flex-wrap"},{default:l(()=>[(n(!0),d(p,null,g(B.value,(a,u)=>(n(),d("div",{key:u,class:"flex gap-2"},[V("div",null,C(a),1),u+1!=B.value.length?(n(),d("div",ve,"、")):b("",!0)]))),128))]),_:1})]),_:1})]),_:1})):b("",!0),D.value.length>0?(n(),y(o,{key:2,cols:"auto",sm:"auto"},{default:l(()=>[e(S,null,{default:l(()=>[e(R,{class:"font-bold sm-text-6 text-4"},{default:l(()=>t[12]||(t[12]=[_("中調")])),_:1}),e(P,{class:"flex gap-2 text-center justify-center sm-text-5 text-4 max-w-[80vw] flex-wrap"},{default:l(()=>[(n(!0),d(p,null,g(D.value,(a,u)=>(n(),d("div",{key:u,class:"flex gap-2"},[V("div",null,C(a),1),u+1!=D.value.length?(n(),d("div",fe,"、")):b("",!0)]))),128))]),_:1})]),_:1})]),_:1})):b("",!0),$.value.length>0?(n(),y(o,{key:3,cols:"auto",sm:"auto"},{default:l(()=>[e(S,null,{default:l(()=>[e(R,{class:"font-bold sm-text-6 text-4"},{default:l(()=>t[13]||(t[13]=[_("後調")])),_:1}),e(P,{class:"flex gap-2 text-center justify-center sm-text-5 text-4 max-w-[80vw] flex-wrap"},{default:l(()=>[(n(!0),d(p,null,g($.value,(a,u)=>(n(),d("div",{key:u,class:"flex gap-2"},[V("div",null,C(a),1),u+1!=$.value.length?(n(),d("div",_e,"、")):b("",!0)]))),128))]),_:1})]),_:1})]),_:1})):b("",!0)]),_:1})]),_:1}),e(v,{class:"border-t"},{default:l(()=>{var a;return[(n(!0),d(p,null,g((a=s.value)==null?void 0:a.product_images_common,u=>(n(),y(o,{cols:"10",class:"m-a"},{default:l(()=>[e(ee,{src:u.image_url},null,8,["src"])]),_:2},1024))),256))]}),_:1}),V("div",me,[t[14]||(t[14]=V("h3",{class:"text-6 py-4"},"相似的商品",-1)),e(v,{class:"border-[#ECBD69] rounded justify-center flex-grow-0 bg-white/80 border-solid border-1px"},{default:l(()=>[(n(!0),d(p,null,g(M.value,a=>(n(),y(o,null,{default:l(()=>[e(de,{prop_data:a},null,8,["prop_data"])]),_:2},1024))),256))]),_:1})])]),_:1}),e(z,{modelValue:L.value,"onUpdate:modelValue":t[6]||(t[6]=a=>L.value=a),timeout:5e3,color:"",class:"",location:"top"},{actions:l(()=>[e(h,{color:"blue",variant:"text",onClick:t[5]||(t[5]=a=>L.value=!1)},{default:l(()=>t[15]||(t[15]=[_(" x ")])),_:1})]),default:l(()=>[t[16]||(t[16]=_(" 成功加入購物車! "))]),_:1},8,["modelValue"]),e(z,{modelValue:U.value,"onUpdate:modelValue":t[8]||(t[8]=a=>U.value=a),timeout:5e3},{actions:l(()=>[e(h,{color:"blue",variant:"text",onClick:t[7]||(t[7]=a=>U.value=!1)},{default:l(()=>t[17]||(t[17]=[_(" x ")])),_:1})]),default:l(()=>[t[18]||(t[18]=_(" 加入購物車失敗 QAQ "))]),_:1},8,["modelValue"])],64)}}});export{Ve as default};
